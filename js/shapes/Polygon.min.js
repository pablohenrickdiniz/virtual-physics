define(["Shape","Color","Border","MV","lodash","FrictionPhysics"],function(g,f,a,b,d,e){var c=function(i){var h=this;g.apply(h);h.vertices=[];h.min=[];h.max=[];h.AABB=null;h.centroid=null;h.bindProperties();h.set(i)};c.prototype=new g;c.prototype.add=function(i){var h=this;if(h.contains(i)){throw new TypeError("Esse vertice já existe no polígono")}else{if(!d.isNumber(i[0])||!d.isNumber(i[1])){throw new TypeError("O vertice deve ser um array de números")}else{h.vertices.push(i)}}return h};c.prototype.contains=function(m){var h=this;var n=false;var l=h.vertices.length;for(var k=0;k<l;k++){var j=h.vertices[k];if(j[0]==m[0]&&j[1]==m[1]){return true}}return false};c.prototype.last=function(){var h=this;if(h.vertices.length>0){return h.vertices[h.vertices.length-1]}return null};c.prototype.removeLast=function(){var h=this;if(h.vertices.length>0){h.vertices.length=h.vertices.length-1}};c.prototype.bindProperties=function(){var h=this;h.onChange("vertices",function(){h.updateCenter()})};c.prototype.isInside=function(n){var j=this;var i=j.getVerticesInWorldCoords();var k=i.length;var l=!1;var h;var m;h=-1;for(m=k-1;++h<k;m=h){(i[h][1]<=n[1]&&n[1]<i[m][1]||i[m][1]<=n[1]&&n[1]<i[h][1])&&n[0]<(i[m][0]-i[h][0])*(n[1]-i[h][1])/(i[m][1]-i[h][1])+i[h][0]&&(l=!l)}return l};c.prototype.getVerticesInWorldCoords=function(){;var k=this;var j=[];var m=k.vertices;var n=m.length;var h=k.getCenter();for(var l=0;l<n;l++){j.push(b.rotate(b.VpV(h,m[l]),b.toDegree(k.theta),h))}return j};c.prototype.getCentroid=function(){;if(this.centroid==null||this.centroid==undefined){this.updateCentroid()}return this.centroid};c.prototype.getCenter=function(){;if(this.center==null||this.center==undefined){this.updateCenter()}return this.center};c.prototype.getRelativeVertices=function(){;var j=this;var m=j.vertices;var l=m.length;var k;var h=[];var n=j.center;for(k=0;k<l;k++){h.push([-(n[0]-m[k][0]),-(n[1]-m[k][1])])}return h};c.prototype.rotate=function(m,j){var h=this;if(j==undefined){j=h.center}else{h.center=b.rotate(h.center,m,j)}var l=h.vertices.length;var k;for(k=0;k<l;k++){h.vertices[k]=b.rotate(h.vertices[k],m,j)}};c.prototype.updateCentroid=function(){;var h=this;h.centroid=c.centroid(h.vertices);h.area=c.area(h.vertices)};c.prototype.updateCenter=function(){;var h=this;h.center=c.verticesCenter(h.vertices)};c.prototype.moi2=function(m){;var q=this;var l=0;var k=0;var o;var j;var p;var h;var r=q.vertices.length;var i;for(i=0;i<r;i++){o=i+1==r?0:i+1;j=q.vertices[i];p=q.vertices[o];h=b.norm(b.VxV(j,p));l+=h*b.dot(p,p)+b.dot(p,j)+b.dot(j,j);k+=h}return(m/6)*(l/k)};c.prototype.moi=function(r){;var x=this;var o=x.getCenter();var q=0;var n;var y=x.vertices.length;var u;var v;var s;var t;var m;var l;var p;var w;var j;var k;for(n=0;n<y;n++){u=n+1==y?0:n+1;v=x.vertices[n];s=x.vertices[u];t=b.distance(v,s);m=b.distance(s,o);l=b.distance(v,o);p=2*(m/l);w=0;if(m<l){w=Math.sqrt(Math.pow(m,2)-Math.pow(p,2))}else{w=Math.sqrt(Math.pow(l,2)-Math.pow(p,2))}j=(Math.pow(p,3)*t-Math.pow(t,2)*p*w+t*p*Math.pow(w,2)+t*Math.pow(p,3))/36;k=(t*p*r)/x.area;q+=j+k*Math.pow(b.distance(o,o),2)}return q};c.prototype.updateRelative=function(){;var j=this;j.vertices=j.vertices.reverse();var h=j.center[0],n=j.center[1],l,k=j.vertices.length,m;for(l=0;l<k;l++){m=j.vertices[l];m[0]=(h-m[0])*-1;m[1]=(n-m[1])*-1}j.updateMinAndMax()};c.prototype.updateMinAndMax=function(){;var k=this;var o=[k.vertices[0][0],k.vertices[0][1]];var h=[k.vertices[0][0],k.vertices[0][1]];var n=k.vertices.length,m,l;for(m=1;m<n;m++){for(l=0;l<=1;l++){if(k.vertices[m][l]<o[l]){o[l]=k.vertices[m][l]}else{if(k.vertices[m][0]>h[l]){h[l]=k.vertices[m][l]}}}}k.min=o;k.max=h};c.prototype.invertPath=function(){var h=this;var i=h.vertices.shift();h.vertices.reverse();h.vertices.unshift(i)};c.prototype.isClockWise=function(){var h=this;var o=0,m,l=h.vertices.length,k,p,n;for(m=0;m<l;m++){k=m+1==l?0:m+1;p=h.vertices[m];n=h.vertices[k];o+=((n[0]-p[0])*(n[1]+p[1]))}return o<0};c.prototype.sumAngles=function(){return c.sumAngles(this.vertices)};c.prototype.isConvex=function(){return c.isConvex(this.vertices)};c.centroid=function(n){var s=this;var h=[0,0];var r=0;var t=n.length;var q;var o;var k;var p;var j;var l;for(l=0;l<t;l++){q=l+1==t?0:l+1;p=n[l];o=n[q];k=p[0]*o[1]-o[0]*p[1];h[0]+=(p[0]+o[0])*k;h[1]+=(p[1]+o[1])*k;r+=k}r*=0.5;j=1/(6*r);h[0]*=j;h[1]*=j;return h};c.verticesCenter=function(h){;var i=e.getAABB2(h);return[(i[2]-i[0])/2,(i[3]-i[1])/2]};c.area=function(l){;var q=0;var r=l.length;var o;var n;var j;var p;var h;var k;for(k=0;k<r;k++){o=k+1==r?0:k+1;p=l[k];n=l[o];j=p[0]*n[1]-n[0]*p[1];q+=j}q*=0.5;return q};c.sumAngles=function(o){var n=0;var m;var u=o.length;var l;var h;var q;var r;var p;var t;var s;if(o.length>=3){for(m=0;m<u;m++){l=m+1;l=l>=u?0:l;h=l+1;h=h>=u?0:h;r=o[m];q=o[l];p=o[h];t=b.VmV(q,r);s=b.VmV(p,q);n+=b.getDegree(t,s)}}return n};c.isConvex=function(h){return c.sumAngles(h)>360};return c});