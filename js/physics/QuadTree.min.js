function QuadTree(h,k){this.AABB=h;this.l=k;this.bodies=[];this.AABBs=[];this.nodes=[];this.qtd=0;this.clear=function(){this.qtd=0;this.bodies=[];this.AABBs=[];for(var a=this.nodes.length,b=0;b<a;b++)void 0!=this.nodes[b]&&0<this.nodes[b].qtd&&this.nodes[b].clear()};this.getAABBsGroups=function(a){a=void 0==a?[]:a;if(0<this.bodies.length&&1<this.qtd)a.push([this.bodies,this.AABBs]);else for(var b=this.nodes.length,c=0;c<b;c++)this.nodes[c].getAABBsGroups(a);return a};this.addBody=function(a,b){b=
    void 0==b?getAABB(a):b;if(5>=this.qtd||5==this.l)this.bodies.push(a),this.AABBs.push(b);else{void 0==this.nodes[0]&&this.split();var c=this.bodies.length;if(0<c){for(var d=0;d<c;d++)this.insert(this.bodies[d],this.AABBs[d]);this.bodies=[];this.AABBs=[]}this.insert(a,b)}this.qtd++};this.removeBody=function(a){var b=!1;if(0<this.bodies.length&&0<this.qtd)a=this.bodies.indexOf(a),-1!=a&&(this.bodies.splice(a,1),this.AABBs.splice(a,1),b=!0);else{var c=this.nodes.length,d,e;for(e=0;e<c;e++)d=this.nodes[e],
    null!=d&&d.removeBody(a)&&(b=!0)}b&&this.qtd--;return b};this.insert=function(a,b){var c,d=this.nodes.length,e;for(c=0;c<d;c++)e=this.nodes[c],AABBoverlap(e.AABB,b,0)&&e.addBody(a,b)};this.split=function(){var a=this.AABB[0],b=this.AABB[1],c=this.AABB[2],d=this.AABB[3],e=a+(c-a)/2,f=b+(d-b)/2,g=this.l+1;this.nodes[0]=new QuadTree([a,b,e,f],g);this.nodes[1]=new QuadTree([e,b,c,f],g);this.nodes[2]=new QuadTree([e,f,c,d],g);this.nodes[3]=new QuadTree([a,f,e,d],g)}};