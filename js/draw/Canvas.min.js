function Canvas(f){if(null==document.getElementById(f))throw new TypeError("Element canvas doesn't exists");this.canvas=f;this.width=MV.toInt($("#"+f).css("width"));this.height=MV.toInt($("#"+f).css("height"));this.context=$("#"+f).get(0).getContext("2d");this.scale=1;this.center=[this.width/2,this.height/2];this.min=[0,0];this.context.setLineDash||(this.context.setLineDash=function(a){});this.drawShape=function(a){a instanceof Body?this.drawBody(a):a instanceof Polygon&&this.drawPolygon(a)};this.drawAABB=
    function(a){this.context.fillStyle="transparent";this.context.strokeRect(a[0]*this.scale,a[1]*this.scale,(a[2]-a[0])*this.scale,(a[3]-a[1])*this.scale)};this.drawQuadTree=function(a,b){1!=b&&this.clearScreen();this.drawAABB(a.AABB);var c=a.nodes.length,d,e;for(d=0;d<c;d++)e=a.nodes[d],void 0!=e&&0<e.qtd&&this.drawQuadTree(e,!0)};this.drawWorld=function(a){this.clearScreen();var b=a.bodies.length;a=a.bodies;var c;for(c=0;c<b;c++)this.drawShape(a[c])};this.drawCircle=function(a){this.drawArc(a)};this.drawArc=
    function(a){this.fillShadow(a.shadow);this.fillShape(a);this.context.beginPath();this.context.arc(a.center[0],a.center[1],a.radius,Math.PI*a.start/180,Math.PI*a.end/180);this.context.fill();this.fillBorder(a.border)};this.drawPolygon=function(a){var b=a.center,c=a.vertices,d=c.length,e=this.scale;this.context.save();this.context.translate(b[0]*e,b[1]*e);this.context.rotate(a.theta);this.context.beginPath();this.context.moveTo(c[0][0]*e,c[0][1]*e);for(b=1;b<d;b++)this.context.lineTo(c[b][0]*e,c[b][1]*
    e);this.context.closePath();this.fillShape(a);this.context.fill();this.fillShadow(a.shadow);this.fillBorder(a.border);this.context.restore()};this.drawBody=function(a){var b=a.shape,c=a.center;a=b.vertices;var d=this.scale,e=a.length;this.context.save();this.context.translate(c[0]*d,c[1]*d);this.context.rotate(b.theta);this.context.beginPath();this.context.moveTo(a[0][0]*d,a[0][1]*d);for(c=1;c<e;c++)this.context.lineTo(a[c][0]*d,a[c][1]*d);this.context.closePath();this.fillShape(b);this.context.fill();
    this.fillShadow(b.shadow);this.fillBorder(b.border);this.context.restore()};this.clearScreen=function(){this.context.clearRect(this.min[0],this.min[1],this.width,this.height)};this.move=function(a){var b=this.center[0]-a[0],c=this.center[1]-a[1];this.center=a;this.min=[a[0]-this.width/2,a[1]-this.height/2];this.context.translate(b,c)};this.fillGradient=function(a){var b=a.color,c=null,d=a.updateMinAndMax(),c=d.maxLevel[0]-d.min[0];a=d.maxLevel[1]-d.min[1];var e=c/2,f=a/2,g=d.min[0]+e,d=d.min[1]+f;if(b instanceof
    RadialGradient)var h=b.r,g=b.cx,d=b.cy,c=this.context.createRadialGradient(g-e+b.fx/100*c,d-f+b.fy/100*a,0,g-e+g/100*c,d-f+d/100*a,h/100*c);else c=this.context.createLinearGradient(g-e+b.px0/100*c,d-f+b.py0/100*a,g-e+b.px1/100*c,d-f+b.py1/100*a);for(a=0;a<b.colorsStop.length;a++)c.addColorStop(b.colorsStop[a][0]/100,this.fillColor(b.colorsStop[a][1]));return c};this.fillColor=function(a){return a instanceof Color?a.toRGBA():a};this.fillShadow=function(a){null!=a&&(this.context.save(),this.context.shadowOffsetX=
    a.x,this.context.shadowOffsetY=a.y,this.context.shadowBlur=a.blur,this.context.shadowColor=this.fillColor(a.color),this.context.fill(),this.context.restore())};this.fillBorder=function(a){null!=a&&(this.context.setLineDash(a.lineDash),this.context.lineCap=a.lineCap,this.context.strokeStyle=this.fillColor(a.color),this.context.lineWidth=a.thickness,this.context.stroke())};this.fillShape=function(a){var b=a.color;this.context.fillStyle=b instanceof LinearGradient||b instanceof RadialGradient?this.fillGradient(a):
    b instanceof Image?b.getFillPattern(this.context):this.fillColor(b)};this.drawImage=function(a){if(a instanceof Image&&a.loaded){var b=a.getElement(),c=a.width,d=a.height;this.context.drawImage(b,a.sx,a.sy,c,d,a.x,a.y,c,d);return!0}}};